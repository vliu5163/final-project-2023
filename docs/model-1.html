<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 [Model 1] | Final Project Proposal</title>
  <meta name="description" content="Chapter 3 [Model 1] | Final Project Proposal" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 [Model 1] | Final Project Proposal" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 [Model 1] | Final Project Proposal" />
  
  
  

<meta name="author" content="Vivian Liu" />


<meta name="date" content="2023-04-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sources.html"/>
<link rel="next" href="model-2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">FINAL</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Proposal</a></li>
<li class="chapter" data-level="2" data-path="sources.html"><a href="sources.html"><i class="fa fa-check"></i><b>2</b> Sources</a></li>
<li class="chapter" data-level="3" data-path="model-1.html"><a href="model-1.html"><i class="fa fa-check"></i><b>3</b> [Model 1]</a></li>
<li class="chapter" data-level="4" data-path="model-2.html"><a href="model-2.html"><i class="fa fa-check"></i><b>4</b> [Model 2]</a></li>
<li class="chapter" data-level="5" data-path="model-3.html"><a href="model-3.html"><i class="fa fa-check"></i><b>5</b> [Model 3]</a></li>
<li class="chapter" data-level="6" data-path="reflections.html"><a href="reflections.html"><i class="fa fa-check"></i><b>6</b> Reflections</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Final Project Proposal</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="model-1" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> [Model 1]<a href="model-1.html#model-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="model-1.html#cb1-1" aria-hidden="true" tabindex="-1"></a>taxi_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&#39;~/Desktop/2021_taxi_data_mod.csv&#39;</span>)</span></code></pre></div>
<p>Split into test and train:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="model-1.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5293</span>)</span>
<span id="cb2-2"><a href="model-1.html#cb2-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(taxi_data)</span>
<span id="cb2-3"><a href="model-1.html#cb2-3" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span>(n, .<span class="dv">8</span><span class="sc">*</span>n)</span>
<span id="cb2-4"><a href="model-1.html#cb2-4" aria-hidden="true" tabindex="-1"></a>train_dat <span class="ot">&lt;-</span> taxi_data[train, ]</span>
<span id="cb2-5"><a href="model-1.html#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># test_dat &lt;- df[-train, ]</span></span>
<span id="cb2-6"><a href="model-1.html#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(train_dat)</span></code></pre></div>
<pre><code>##       X.1        X VendorID   tpep_pickup_datetime  tpep_dropoff_datetime
## 2885 2909 12405440        2 07/03/2021 07:28:51 PM 07/03/2021 07:37:38 PM
## 10     10  7142653        2 05/05/2021 11:30:48 AM 05/05/2021 11:50:01 AM
## 3208 3234 18732634        2 09/11/2021 07:30:46 PM 09/11/2021 07:46:37 PM
## 3649 3678 29380007        2 12/15/2021 07:52:46 AM 12/15/2021 08:16:21 AM
## 4464 4502 25171931        2 11/09/2021 02:29:21 PM 11/09/2021 03:03:43 PM
## 735   741 25126790        2 11/09/2021 06:40:41 AM 11/09/2021 06:48:09 AM
##      passenger_count trip_distance RatecodeID store_and_fwd_flag PULocationID
## 2885               1          0.00          1                  N          231
## 10                 1          2.38          1                  N          236
## 3208               2          1.57          1                  N          231
## 3649               1          2.58          1                  N          162
## 4464               1          3.64          1                  N          163
## 735                1          1.85          1                  N          239
##      DOLocationID payment_type fare_amount extra mta_tax tip_amount
## 2885          246            1         6.5     0     0.5       1.47
## 10            164            1        13.5     0     0.5       5.04
## 3208           79            1        11.0     0     0.5       2.86
## 3649          239            1        15.5     0     0.5       2.82
## 4464          163            1        22.0     0     0.5      25.30
## 735           230            1         8.0     0     0.5       2.00
##      tolls_amount improvement_surcharge total_amount congestion_surcharge
## 2885            0                   0.3        11.27                  2.5
## 10              0                   0.3        21.84                  2.5
## 3208            0                   0.3        17.16                  2.5
## 3649            0                   0.3        21.62                  2.5
## 4464            0                   0.3        50.60                  2.5
## 735             0                   0.3        13.30                  2.5
##      tipped tip high_fare              pickup             dropoff  duration
## 2885      1   1         0 2021-07-03 19:28:51 2021-07-03 19:37:38  8.783333
## 10        1   1         0 2021-05-05 11:30:48 2021-05-05 11:50:01 19.216667
## 3208      1   1         0 2021-09-11 19:30:46 2021-09-11 19:46:37 15.850000
## 3649      1   1         0 2021-12-15 07:52:46 2021-12-15 08:16:21 23.583333
## 4464      1   1         1 2021-11-09 14:29:21 2021-11-09 15:03:43 34.366667
## 735       1   1         0 2021-11-09 06:40:41 2021-11-09 06:48:09  7.466667
##      season pickup_borough dropoff_borough
## 2885 summer      Manhattan       Manhattan
## 10   spring      Manhattan       Manhattan
## 3208 autumm      Manhattan       Manhattan
## 3649 winter      Manhattan       Manhattan
## 4464 autumm      Manhattan       Manhattan
## 735  autumm      Manhattan       Manhattan</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="model-1.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># my accuracy is really low when I run line 31. Line 32 doesn&#39;t work at all</span></span>
<span id="cb4-2"><a href="model-1.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(OneR)</span>
<span id="cb4-3"><a href="model-1.html#cb4-3" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">OneR</span>(tip <span class="sc">~</span> pickup_borough <span class="sc">+</span> dropoff_borough <span class="sc">+</span> passenger_count <span class="sc">+</span> high_fare, <span class="at">data =</span> train_dat)</span>
<span id="cb4-4"><a href="model-1.html#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code></pre></div>
<pre><code>## 
## Call:
## OneR.formula(formula = tip ~ pickup_borough + dropoff_borough + 
##     passenger_count + high_fare, data = train_dat)
## 
## Rules:
## If dropoff_borough = Bronx     then tip = 0
## If dropoff_borough = Brooklyn  then tip = 1
## If dropoff_borough = EWR       then tip = 0
## If dropoff_borough = Manhattan then tip = 1
## If dropoff_borough = Queens    then tip = 1
## If dropoff_borough = unknown   then tip = 0
## 
## Accuracy:
## 2524 of 3783 instances classified correctly (66.72%)
## 
## Contingency table:
##      dropoff_borough
## tip   Bronx Brooklyn EWR Manhattan Queens unknown  Sum
##   0    * 29       60 * 3      1099     83    * 19 1293
##   1       4     * 76   1    * 2305   * 92      12 2490
##   Sum    33      136   4      3404    175      31 3783
## ---
## Maximum in each column: &#39;*&#39;
## 
## Pearson&#39;s Chi-squared test:
## X-squared = 80.442, df = 5, p-value = 6.782e-16</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="model-1.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod)</span></code></pre></div>
<p><img src="finalproj_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="model-1.html#cb7-1" aria-hidden="true" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, train_dat)</span>
<span id="cb7-2"><a href="model-1.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">eval_model</span>(prediction, train_dat)</span></code></pre></div>
<pre><code>## 
## Confusion matrix (absolute):
##                Actual
## Prediction         0    1 Bronx Brooklyn  EWR Manhattan Queens Staten Island
##   0                0    0    41        0    6         0      0             0
##   1                0    0     0      174    0      3511    202             0
##   Bronx            0    0     0        0    0         0      0             0
##   Brooklyn         0    0     0        0    0         0      0             0
##   EWR              0    0     0        0    0         0      0             0
##   Manhattan        0    0     0        0    0         0      0             0
##   Queens           0    0     0        0    0         0      0             0
##   Staten Island    0    0     0        0    0         0      0             0
##   unknown          0    0     0        0    0         0      0             0
##   UNSEEN           0    0     0        0    0         0      0             1
##   Sum              0    0    41      174    6      3511    202             1
##                Actual
## Prediction      unknown UNSEEN  Sum
##   0                  31      0   78
##   1                   0      0 3887
##   Bronx               0      0    0
##   Brooklyn            0      0    0
##   EWR                 0      0    0
##   Manhattan           0      0    0
##   Queens              0      0    0
##   Staten Island       0      0    0
##   unknown             0      0    0
##   UNSEEN              0      0    1
##   Sum                31      0 3966
## 
## Confusion matrix (relative):
##                Actual
## Prediction         0    1 Bronx Brooklyn  EWR Manhattan Queens Staten Island
##   0             0.00 0.00  0.01     0.00 0.00      0.00   0.00          0.00
##   1             0.00 0.00  0.00     0.04 0.00      0.89   0.05          0.00
##   Bronx         0.00 0.00  0.00     0.00 0.00      0.00   0.00          0.00
##   Brooklyn      0.00 0.00  0.00     0.00 0.00      0.00   0.00          0.00
##   EWR           0.00 0.00  0.00     0.00 0.00      0.00   0.00          0.00
##   Manhattan     0.00 0.00  0.00     0.00 0.00      0.00   0.00          0.00
##   Queens        0.00 0.00  0.00     0.00 0.00      0.00   0.00          0.00
##   Staten Island 0.00 0.00  0.00     0.00 0.00      0.00   0.00          0.00
##   unknown       0.00 0.00  0.00     0.00 0.00      0.00   0.00          0.00
##   UNSEEN        0.00 0.00  0.00     0.00 0.00      0.00   0.00          0.00
##   Sum           0.00 0.00  0.01     0.04 0.00      0.89   0.05          0.00
##                Actual
## Prediction      unknown UNSEEN  Sum
##   0                0.01   0.00 0.02
##   1                0.00   0.00 0.98
##   Bronx            0.00   0.00 0.00
##   Brooklyn         0.00   0.00 0.00
##   EWR              0.00   0.00 0.00
##   Manhattan        0.00   0.00 0.00
##   Queens           0.00   0.00 0.00
##   Staten Island    0.00   0.00 0.00
##   unknown          0.00   0.00 0.00
##   UNSEEN           0.00   0.00 0.00
##   Sum              0.01   0.00 1.00
## 
## Accuracy:
## 0 (0/3966)
## 
## Error rate:
## 1 (3966/3966)
## 
## Error rate reduction (vs. base rate):
## -7.7165 (p-value = 1)</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="model-1.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">predict</span>(mod, train_dat) <span class="sc">==</span> train_dat<span class="sc">$</span>tip_amount)</span></code></pre></div>
<pre><code>## [1] 0.06404438</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="model-1.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mean(predict(mod, test_dat) == test_dat$tip_amount)</span></span></code></pre></div>
<p>Based on the OneR analysis, it seems that pickup borough is the most important in determining whether or not a rider will tip over 15% on their ride. As we can see from the plot, there are 5 categories (Bronx, Brooklyn, Manhattan, Queens, and unknown borough). Riders who are picked up in Manhattan have the highest rate of tipping over 15%, and riders who are picked up from the Bronx have the lowest rate of tipping over 15%. This made sense intuitively when I looked up the median household income for the different boroughs after making this plot. Highest to lowest median income goes Manhattan, Staten Island, Queens, Brooklyn, then Bronx which is the same order for tipping &gt;15% in this plot.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="model-1.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># testing</span></span>
<span id="cb12-2"><a href="model-1.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb12-3"><a href="model-1.html#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb12-4"><a href="model-1.html#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="model-1.html#cb12-5" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">rpart</span>(tip <span class="sc">~</span> pickup_borough <span class="sc">+</span> dropoff_borough <span class="sc">+</span> season <span class="sc">+</span> high_fare, <span class="at">data =</span> train_dat, </span>
<span id="cb12-6"><a href="model-1.html#cb12-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">&quot;class&quot;</span>, </span>
<span id="cb12-7"><a href="model-1.html#cb12-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">control=</span><span class="fu">rpart.control</span>(<span class="at">cp=</span><span class="dv">0</span>))</span>
<span id="cb12-8"><a href="model-1.html#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(mod1, <span class="at">main =</span> <span class="st">&quot;tip&quot;</span>, <span class="at">under=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="finalproj_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="sources.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="model-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/vliu5163/final-project-2023/edit/main/model1.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/vliu5163/final-project-2023/blob/main/model1.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
